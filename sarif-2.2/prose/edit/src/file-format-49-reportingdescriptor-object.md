## reportingDescriptor object

### General{#reportingdescriptor-object--general}

A `reportingDescriptor` object contains information that describes a "reporting item" generated by a tool. A reporting item is either a result produced by the tool’s analysis (see [sec](#result-object)), or a notification of a condition encountered by the tool ([sec](#notification-object)). We refer to this descriptive information as "reporting item metadata." When referring to the metadata that describes a result, we use the more specific term "rule metadata."

Some of the properties of the `reportingDescriptor` object are interpreted differently depending on whether the object represents a rule or a notification. The description of each property will specify any such differences.

### Constraints{#reportingdescriptor-object--constraints}

Either the `shortDescription` property ([sec](#reportingdescriptor-object--shortdescription-property)) or the `fullDescription` property ([sec](#reportingdescriptor-object--fulldescription-property)) or both **SHOULD** be present.

### id property{#reportingdescriptor-object--id-property}

A `reportingDescriptor` object **SHALL** contain a property named `id` whose value is a string. In the case of a rule, `id` **SHALL** contain a stable identifier for the rule and **SHOULD** be opaque. In the case of a notification, `id` does not need be a stable, opaque identifier; it **MAY** be a user-readable identifier.

> EXAMPLE 1: `"id": "CA2101"`

> NOTE 1: Rule identifiers must be stable for two reasons:
>
> - So build automation scripts can refer to specific checks, for example, to disable them, without the risk of a script breaking if a rule id changes.
>
> - So result management systems can compare results from one run to the next, without erroneously designating results as "new" because a rule id has changed.
>
> Rule identifiers should be opaque – that is, they should not convey information to a user – because a rule's implementation might change over time. Suppose a rule id is `"DoNotDoXOrY"`, suppose circumstances change so that "Y" is now acceptable, and suppose the implementation of the rule changes accordingly. Because the rule id must not change, the string `"DoNotDoXOrY"` will continue to be persisted to logs, where it will convey outdated guidance to users in a way that an opaque identifier such as "`CA2101"` would not.

> NOTE 2: Despite the fact that the `result.ruleId` property ([sec](#ruleid-property)) is permitted to be a hierarchical string ([sec](#hierarchical-strings)) whose trailing components denote a subset of the specified rule, SARIF does not support separate metadata for such "sub-rules". The `id` property of a `reportingDescriptor` object always specifies an entire rule (or notification), not a subset of one.

### deprecatedIds property

A `reportingDescriptor` object **MAY** contain a property named `deprecatedIds` whose value is an array of zero or more unique ([sec](#array-properties-with-unique-values)) strings each of which contains an id (see [sec](#reportingdescriptor-object--id-property)) by which this reporting item was known in some previous version of the analysis tool.

> NOTE: This property is most useful for rules. It addresses the scenario where rule ids change from one version of a tool to the next. For example, a tool developer might decide that a rule is too general, covering too many concepts. In the next version of the tool, the tool developer might break this rule into a set of more specific rules.

Now the result management system has the problem of matching results between the newer and the older versions of the tool. `deprecatedIds` solves this problem.

> EXAMPLE 1: In this example, version 1 of an analysis tool defines rule `CA1000`. A run of this tool finds two results. The result management system decides that neither result was previously detected, so it marks them as with `"baselineState": "new"` ([sec](#baselinestate-property)), producing this log:
>
> ```json
> {
>   "tool": {
>     "driver": {
>       "name": "CodeScanner",
>       "version": "1",
>       "rules": [
>         {
>           "id": "CA1000",
>           ...
>         }
>       ]
>     }
>   },
>   "results": [
>     {
>       "ruleId": "CA1000",
>       "rule": {
>         "index": 0
>       },
>       "baselineState": "new",
>       ...
>     },
>     {
>       "ruleId": "CA1000",
>       "rule": {
>         "index": 0
>       },
>       "baselineState": "new",
>       ...
>     }
>   ]
> }
> ```
>
> The engineering team decides that these results are false positive, so they add in-source suppressions, for example (in C#):
>
>     [SuppressMessage("CA1000", ...)]
>     ...
>     [SuppressMessage("CA1000", ...)]
>
> Now the tool developers decide that rule `CA1000` is too broad, so in version 2 of the tool, they divide it into two new rules, `CA1001` and `CA1002`. The engineering team runs the new tool, and the result management system performs result matching, producing this log:
>
> ```json
> {
>   "tool": {
>     "driver": {
>       "name": "CodeScanner",
>       "version": "2",
>       "rules": [
>         {
>           "id": "CA1001",
>           "deprecatedIds": [
>             "CA1000"
>           ],
>           ...
>         },
>         {
>           "id": "CA1002",
>           "deprecatedIds": [
>             "CA1000"
>           ],
>           ...
>         }
>       ]
>     }
>   },
>   "results": [
>     {
>       "ruleId": "CA1001",
>       "rule": {
>         "index": 0
>       },
>       "baselineState": "unchanged",
>       "suppressions": [
>         {
>           "kind": "inSource"
>         }
>       ],
>       ...
>     },
>     {
>       "ruleId": "CA1002",
>       "rule": {
>         "index": 1
>       },
>       "baselineState": "updated",
>       "suppressions": [
>         {
>           "kind": "inSource"
>         }
>       ],
>       ...
>     }
>   ]
> }
> ```
>
> There are a few things to notice:
>
> - In `tool.driver.rules`, each of the new rules is associated with its id from the previous tool version.
>
> - As a result, the analysis tool can determine that the in-source suppressions still apply, even though the rule ids have changed, so it correctly marks each result with `"kind": "inSource"`.
>
> - Furthermore, the result management system can determine that these are the same results it saw in the previous run, so it correctly marks them with `"baselineState": "unchanged"` or `"updated"` as appropriate (see [sec](#baselinestate-property)).

### guid property{#reportingdescriptor-object--guid-property}

A `reportingDescriptor` object **MAY** contain a property named `guid` whose value is a GUID-valued string ([sec](#guid-valued-strings)) that uniquely identifies the descriptor.

### deprecatedGuids property

A `reportingDescriptor` object **MAY** contain a property named `deprecatedGuids` whose value is an array of zero or more unique ([sec](#array-properties-with-unique-values)) GUID-valued strings ([sec](#guid-valued-strings)) each of which was used by a previous version of the tool as the value of the `guid` property ([sec](#reportingdescriptor-object--guid-property)) for this object.

### name property{#reportingdescriptor-object--name-property}

A `reportingDescriptor` object **MAY** contain a property named `name` whose value is a localizable string ([sec](#localizable-strings)) containing an identifier that is understandable to an end user. If the `name` of a rule contains implementation details that change over time, a tool author might alter a rule's name (while leaving the stable `id` property ([sec](#reportingdescriptor-object--id-property)) unchanged).

> NOTE: A rule name is suitable in contexts where a readable identifier is preferable and where the lack of stability is not a concern.

> EXAMPLE 1: `"name": "``SpecifyMarshalingForPInvokeStringArguments"`

### deprecatedNames property

A `reportingDescriptor` object **MAY** contain a property named `deprecatedNames` whose value is an array of zero or more unique ([sec](#array-properties-with-unique-values)) localizable ([sec](#localizable-strings)) strings each of which was used by a previous version of the tool as the value of the `name` property ([sec](#reportingdescriptor-object--name-property)) for this object.

The array elements **SHALL** occur in the same order in every translation ([sec](#taxonomies)).

### shortDescription property{#reportingdescriptor-object--shortdescription-property}

A `reportingDescriptor` object **MAY** contain a property named `shortDescription` whose value is a localizable `multiformatMessageString` object ([sec](#multiformatmessagestring-object), [sec](#localizable-multiformatmessagestrings)) that provides a concise description of the reporting item. The `shortDescription` property **SHOULD** be a single sentence that is understandable when visible space is limited to a single line of text.

> EXAMPLE 1:
>
> ```json
> {                         # A reportingDescriptor object
>   "shortDescription": {
>     "text": "Specify marshaling for P/Invoke string arguments."
>   }
> }
> ```

### fullDescription property{#reportingdescriptor-object--fulldescription-property}

A `reportingDescriptor` object **SHOULD** contain a property named `fullDescription` whose value is a localizable `multiformatMessageString` object ([sec](#multiformatmessagestring-object), [sec](#localizable-multiformatmessagestrings)) that comprehensively describes the reporting item.

The `fullDescription` property **SHOULD**, as far as possible, provide details sufficient to enable resolution of any problem indicated by the reporting item.

The beginning of `fullDescription` (for example, its first sentence) **SHOULD** provide a concise description of the reporting item, suitable for display in cases where available space is limited. Tools that construct `fullDescription` in this way do not need to provide a value for `shortDescription` ([sec](#reportingdescriptor-object--shortdescription-property)). Tools that do not construct `fullDescription` in this way **SHOULD** provide a value for `shortDescription`.

> NOTE:The rationale for this guidance is that in the absence of `shortDescription`, a viewer with limited display space might display a truncated version of `fullDescription`, for example, the first sentence (if a sentence is identifiable), the first paragraph, or the first 100 characters. If this guidance is not followed, that truncated version might not be understandable.

### messageStrings property

A `reportingDescriptor` object **MAY** contain a property named `messageStrings` whose value is an object ([sec](#object-properties)) consisting of a set of properties with arbitrary names, each of whose values is a localizable `multiformatMessageString` object ([sec](#multiformatmessagestring-object), [sec](#localizable-multiformatmessagestrings)).

If the `reportingDescriptor` object defines a rule, the set of property names appearing in the `messageStrings` property **SHALL** contain at least the set of strings which occur as values of `result.message.id` properties ([sec](#result-object--message-property), [sec](#message-object--id-property)) in the current `run` object. The `messageStrings` property **MAY** contain additional properties whose names do not appear as the value of the `result.message.id` property for any `result` object in the `run`.

If the `reportingDescriptor` object describes a notification, the set of property names appearing in the `messageStrings` property **SHALL** contain at least the set of strings which occur as values of `notification.message.id` for any `notification` object in the run.

> NOTE: Additional properties are permitted in the `messageStrings` property for the convenience of tool vendors, who might find it easier to emit the entire set of messages defined in the reporting metadata, rather than restricting it to those messages that happen to appear in the log file.

> EXAMPLE 1:
>
> ```json
> {                         # A reportingDescriptor object for a rule.
>   "messageStrings": {
>     "objectCreation":  {  # A multiformatMessageString object ((#multiformatmessagestring-object)).
>       "text": "{0} creates a new instance of {1} which is never used.
>               Pass the instance as an argument to another method,
>               assign the instance to a variable,
>               or remove the object creation if it is unnecessary."
>     },  
>     "stringReturnValue": {
>       "text": "{0} calls {1} but does not use the new string
>               instance that the method returns.
>               Pass the instance as an argument to another method,
>               assign the instance to a variable,
>               or remove the call if it is unnecessary."
>     }
>   }    
> }
> ```

### helpUri property

A `reportingDescriptor` object **MAY** contain a property named `helpUri` whose value is a localizable string ([sec](#localizable-strings)) containing the absolute URI \[[cite](#RFC3986)\] of the primary documentation for the reporting item.

> NOTE 1: The documentation might include examples, contact information for the authors, and links to additional information.

> NOTE 2: This property is localizable so that help information in different languages can be viewed at different URIs.

### help property

A `reportingDescriptor` object **MAY** contain a property named `help` whose value is a localizable `multiformatMessageString` object ([sec](#multiformatmessagestring-object), [sec](#localizable-multiformatmessagestrings)) which provides the primary documentation for the reporting item.

> NOTE: This property is useful when help information is not available at a URI, for example, in the case of a custom rule written by a developer, as opposed to one supplied by the tool vendor.

### defaultConfiguration property

A `reportingDescriptor` object **MAY** contain a property named `defaultConfiguration` whose value is a `reportingConfiguration` object ([sec](#reportingconfiguration-object)).

If this property is absent, it **SHALL** be taken to be present, and its properties **SHALL** be taken to have the default values specified in [sec](#reportingconfiguration-object).

The rule- or notification-specific configuration parameters for a `reportingDescriptor`, if any, **SHALL NOT** be stored in its property bag ([sec](#property-bags)) Rather, they **SHALL** be stored in `defaultConfiguration.parameters` ([sec](#reportingconfiguration-object--parameters-property)).

### relationships property{#reportingdescriptor-object--relationships-property}

A `reportingDescriptor` object **MAY** contain a property named `relationships` whose value is an array of zero or more unique ([sec](#array-properties-with-unique-values)) `reportingDescriptorRelationship` objects ([sec](#reportingdescriptorrelationship-object)) each of which declares one or more directed relationships from `thisObject` to another `reportingDescriptor` object, which we refer to as `theTarget`, specified by `reportingDescriptorRelationship`.`target` ([sec](#reportingdescriptorrelationship-object--target-property)). The natures of the relationships between `thisObject` and `theTarget` are specified by `reportingDescriptorRelationship.kinds` ([sec](#reportingdescriptorrelationship-object--kinds-property)).
