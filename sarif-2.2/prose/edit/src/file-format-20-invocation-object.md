## invocation object

### General{#invocation-object--general}

An `invocation` object describes the invocation of the analysis tool that was run.

### commandLine property

An `invocation` object **MAY** contain a property named `commandLine` whose value is a string containing the completely specified command line used to invoke the tool, starting with the name of the tool's executable or script file, optionally qualified by the relative or absolute path to the file.

> NOTE 1: The information in the `commandLine` property helps to precisely repeat a run of an analysis tool, and to verify that the results reported in the log file were generated by an appropriate invocation of the tool.

The `commandLine` property is redactable ([sec](#redactable-strings)) because it might contain information which it is not appropriate to disclose, such as passwords, tokens, database connection strings, or in some circumstances even the fully qualified path to the tool's executable or script file.

> NOTE 2: Redacting sensitive information from `commandLine` makes it more difficult to precisely reproduce an analysis run. The value of `commandLine` would have to be combined with information from another source to allow the run to be repeated.

> EXAMPLE 1: Suppose a tool is invoked with the command line
> 
>     C:\Users\mary\Tools\DbScanner.exe /ConnectionString  
>     "Server=Corp;Db=Accounting;User=Admin;Password=S3cr#t"  
>     /input *.sql
> 
> Then `commandLine` might contain the redacted string
> 
>     [REDACTED]\DbScanner.exe /connectionString=[REDACTED] /input=*.sql

The `commandLine` property might describe a command that would be harmful if it were executed. For this reason, a SARIF consumer that receives a SARIF log file from an untrusted source **SHOULD NOT** execute the command line without first examining it carefully. In particular, an automated SARIF consumer **SHALL NOT** execute a command line in a SARIF log file from an untrusted source.

> EXAMPLE 2: An example of a harmful command line:
> 
> ```
>   {                               # An invocation object
>     "commandLine": "rm -rf /"
>   }
> ```

### arguments property{#invocation-object--arguments-property}

An `invocation` object **MAY** contain a property named `arguments` whose value is either `null` or an array of zero or more strings, containing in order the command line arguments passed to the tool from the operating system.

If `arguments` is absent, it **SHALL** default to `null`.

An empty array **SHALL** mean that the tool was invoked with no command line arguments. `null` **SHALL** mean that the command line arguments, if any, are not known.

> EXAMPLE 1: If the tool is implemented as a C# or Java program, `arguments` would contain the contents of the `args` array passed to the entry point method.

> NOTE: Although the `commandLine` property ([sec](#commandline-property)) contains the same information, parsing it is error prone even if one understands the command shell’s quoting and escaping conventions. SARIF consumers might find the pre-parsed `arguments` property easier to use.

### responseFiles property

An `invocation` object **MAY** contain a property named `responseFiles` whose value is either `null` or an array of zero or more unique ([sec](#array-properties-with-unique-values)) `artifactLocation` objects ([sec](#artifactlocation-object)) each of which represents a response file specified on the tool's command line.

If `responseFiles` is absent, it **SHALL** default to `null`.

An empty array **SHALL** mean that the tool was invoked with no command line arguments that specified response files. `null` **SHALL** mean that it is not known whether any command line arguments specified a response file.

A SARIF producer **MAY** embed the contents of a response file in the SARIF log file by mentioning the response file in `theRun.artifacts` ([sec](#artifacts-property)) and providing a value for `artifact.contents` ([sec](#artifact-object--contents-property)).

> EXAMPLE 1:
> 
> ```json
> {                       # An invocation object.
>     "commandLine": "/quiet @analyzer.rsp @strict.rsp @options.rsp",
> 
>     "responseFiles": [
>       {                 # An artifactLocation object (§3.4).
>         "uri": "analyzer.rsp",
>         "uriBaseId": "RESPONSEFILEDIR"
>       },
>       {
>         "uri": "strict.rsp",
>         "uriBaseId": "RESPONSEFILEDIR"
>       },
>       {
>         "uri": "options.rsp",
>         "uriBaseId": "RESPONSEFILEDIR"
>       }
>     ],
>     ...
> }
> ```

### ruleConfigurationOverrides property

An `invocation` object **MAY** contain a property named `ruleConfigurationOverrides` whose value is an array of zero or more unique ([sec](#array-properties-with-unique-values)) `configurationOverride` objects ([sec](#configurationoverride-object)) each of which overrides the `defaultConfiguration` property ([sec](#defaultconfiguration-property)) of a `reportingDescriptor` object ([sec](#conversionsources-property)) that describes a rule (that is, a `reportingDescriptor` object that is an array element of the `rules` property ([sec](#rules-property)) of some `toolComponent` object ([sec](#toolcomponent-object))).

### notificationConfigurationOverrides property

An `invocation` object **MAY** contain a property named `notificationConfigurationOverrides` whose value is an array of zero or more unique ([sec](#array-properties-with-unique-values)) `configurationOverride` objects ([sec](#configurationoverride-object)) each of which overrides the `defaultConfiguration` property ([sec](#defaultconfiguration-property)) of a `reportingDescriptor` object ([sec](#reportingdescriptor-object)) that describes a notification (that is, a `reportingDescriptor` object that is an array element of the `notifications` property ([sec](#notifications-property)) of some `toolComponent` object ([sec](#toolcomponent-object))).

### startTimeUtc property

An `invocation` object **MAY** contain a property named `startTimeUtc` whose value is a string in the format specified in [sec](#datetime-properties), specifying the UTC date and time at which the invocation started.

### endTimeUtc property

An `invocation` object **MAY** contain a property named `endTimeUtc` whose value is a string in the format specified in [sec](#datetime-properties), specifying the UTC date and time at which the invocation ended.

### exitCode property

If the SARIF producer process did not exit due to a signal, an `invocation` object **SHOULD** contain a property named `exitCode` whose value is an integer specifying the process exit code.

If the SARIF producer process exited due to a signal, the `exitCode` property **SHALL** be absent.

For examples, see [sec](#exitcodedescription-property).

### exitCodeDescription property

If the SARIF producer process did not exit due to a signal, an `invocation` object **MAY** contain a property named `exitCodeDescription` whose value is a string describing the reason for the process exit.

> EXAMPLE 1:
> 
> ```json
> {                       # An invocation object
>   "exitCode": 0,
>   "exitCodeDescription": "Normal successful completion"
> }
> ```

> EXAMPLE 2:
> 
> ```json
> {                       # An invocation object
>   "exitCode": 2,
>   "exitCodeDescription": "File not found"
> }
> ```

### exitSignalName property

If the SARIF producer process exited due to a signal, an `invocation` object **SHOULD** contain a property named `exitSignalName` whose value is a string containing the name of the signal that caused the process to exit.

If the SARIF producer process did not exit due to a signal, the `exitSignalName` property **SHALL** be absent.

For an example, see [sec](#exitsignalnumber-property).

### exitSignalNumber property

If the SARIF producer process exited due to a signal, an `invocation` object **MAY** contain a property named `exitSignalNumber` whose value is an integer specifying the numeric value of the signal that caused the process to exit.

If the SARIF producer process did not exit due to a signal, the `exitSignalNumber` property **SHALL** be absent.

> EXAMPLE 1:
> 
> ```json
> {                       # An invocation object
>   "exitSignalNumber": 3,
>   "exitSignalName": "SIGQUIT"
> }
> ```

### processStartFailureMessage property

If the analysis tool process failed to start, an `invocation` object **MAY** contain a property named `processStartFailureMessage` whose value is a string containing the operating system’s message describing the failure.

> NOTE: In this case, the SARIF file would not be produced by the analysis tool (since it failed to start), but rather by some other component of the user’s engineering system which is responsible for monitoring the operation of the analysis tool.

If the analysis tool process started successfully (regardless of whether or how it subsequently failed), the `processStartFailureMessage` property **SHALL** be absent.

> EXAMPLE 1:
> 
> ```json
> {                       # An invocation object
>   "processStartFailureMessage": "WebScan.exe is not recognized as a command."
> }
> ```

### executionSuccessful property

An `invocation` object **SHALL** contain a property named `executionSuccessful` whose value is a Boolean that is `true` if the engineering system that started the process knows that the analysis tool succeeded, and `false` if the engineering system knows that the tool failed.

> NOTE: This property is needed because not all programs exit with an exit code of 0 on success and non-0 on failure.

> EXAMPLE 1:
> 
> ```json
> {
>   "exitCode": 1,
>   "exitCodeDescription": "Scan successful; warnings detected.",
>   "executionSuccessful": true
> }
> ```

### machine property

An `invocation` object **MAY** contain a property named `machine` whose value is a redactable ([sec](#redactable-strings)) string containing the name of the machine on which the invocation occurred.

### account property

An `invocation` object **MAY** contain a property named `account` whose value is a redactable ([sec](#redactable-strings)) string containing the name of the account under which the invocation occurred.

### processId property

An `invocation` object **MAY** contain a property named `processId` whose value is an integer containing the id of the process in which the invocation occurred.

### executableLocation property

An `invocation` object **MAY** contain a property named `executableLocation` whose value is an `artifactLocation` object ([sec](#artifactlocation-object)) specifying the location of the primary executable file for the program or script that was invoked.

> NOTE 1: This property is defined in the `invocation` object rather than in the `toolComponent` object ([sec](#toolcomponent-object)) because the identical tool might be invoked from different paths on different machines.

> NOTE 2: This property might duplicate information in the `commandLine` property ([sec](#commandline-property)). It is necessary because the command line might not explicitly specify the path to the tool (for example, if the tool directory is on the execution path), and this information is important for troubleshooting.

> NOTE 3: Absolute path names can reveal information that might be sensitive.

### workingDirectory property

An `invocation` object **MAY** contain a property named `workingDirectory` whose value is an `artifactLocation` object ([sec](#artifactlocation-object)) specifying the fully qualified path name of the process’s working directory (a directory that the operating system associates with the process, with respect to which the operating system interprets relative file paths).

> NOTE: Absolute path names can reveal information that might be sensitive.

### environmentVariables property

An `invocation` object **MAY** contain a property named `environmentVariables` whose value is an object. The property names in this object **SHALL** contain the names of all the environment variables in the tool's execution environment. The value of each property **SHALL** be a string containing the value of the specified environment variable. If the value of the environment variable is an empty string, the corresponding property value **SHALL** be an empty string.

> NOTE 1: Environment variables might be useful to include in a log file because they might affect the tool’s analysis output, for example, by specifying the location of a directory containing plugins (see [sec](#tool-object--general)). However, environment variable names and values are likely to reveal highly sensitive information. For example, on a machine running Microsoft Windows®, environment variables reveal the directories on the execution path, user account name, machine name, logon domain controller, *etc.*

> NOTE 2: The result of setting an environment variable to an empty string is operating system dependent. On Microsoft Windows®, it removes the variable from the environment. In UNIX®, an environment variable can have an empty value.

Both the property names and their values are redactable ([sec](#redactable-strings)). A distinct redaction token ([sec](#redactiontokens-property)) **SHALL** be used for each redacted property name.

> NOTE 3: This is necessary to prevent the creation of an object with identical property names, which is invalid in the JSON serialization.

### toolExecutionNotifications property

An `invocation` object **MAY** contain a property named `toolExecutionNotifications` whose value is an array of zero or more `notification` objects ([sec](#notification-object)). Each element of the array represents a runtime condition detected by the invoked process, either by the tool’s driver or by one of its extensions. The presence within this array of any `notification` object whose level property ([sec](#notification-object--level-property)) is `"error"` **SHALL** mean that the run failed. A SARIF consumer **SHALL NOT** assume that a failed run contains a complete set of analysis results.

> NOTE: This is important in compliance scenarios, where, for example, a corporate policy might require that a project’s entire code base be analyzed with a specified set of rules.

The information in `toolExecutionNotifications` is primarily intended for the developers of the analysis tool, to aid them in diagnosing bugs in the tool. This contrasts with the information in `results`, which is intended for the developers of the code being analyzed. However, viewers **MAY** still present tool notifications to users, so users are aware of any tool problems. At a minimum, viewers **SHOULD** make users aware of tool notifications whose `level` property is `"error"`.

> NOTE: Depending on the nature of the error, a tool that encounters a runtime error might or might not be able to continue running.  
>   
> If the error occurs in the course of evaluating a rule, the tool might report the error in `toolExecutionNotifications`, disable the rule, and continue to execute the remaining rules.  
>   
> If the error occurs outside of the evaluation of a rule, the tool might report the error in `toolExecutionNotifications` and then halt. If the tool exits abnormally, it might not have the opportunity to report the error. But if the tool is running under the control of an orchestration process that can detect the error, that process might add a notification for the error to the log file, or even synthesize a log file to hold the error, if the tool did not have the opportunity to create one.

### toolConfigurationNotifications property

An `invocation` object **MAY** contain a property named `toolConfigurationNotifications` whose value is an array of zero or more `notification` objects ([sec](#notification-object)). Each element of the array represents a condition relevant to the configuration of the tool's driver or one of its extensions. The presence within this array of any `notification` object whose `level` property ([sec](#notification-object--level-property)) is `"error"` **SHALL** mean that the run failed.

The information in `toolConfigurationNotifications` is primarily intended for the engineers who configure the analysis tool, to aid them in diagnosing errors in the configuration. This contrasts with the information in `results`, which is intended for the developers of the code being analyzed. However, viewers **MAY** still present configuration notifications to users, so users are aware of any configuration problems. At a minimum, viewers **SHOULD** make users aware of configuration notifications whose `level` property is `"error"`.

> NOTE: Many tools can be parameterized with information about which rules to run, and how those rules should be configured. In some cases, if the configuration information is invalid, the tool can ignore the invalid information and continue to run.

> EXAMPLE 1: A tool is invoked with a configuration file which specifies that the tool should disable rule `ABC0001`, but there is no rule whose id is `ABC0001`. The tool reports the problem in `toolConfigurationNotifications`. The tool might continue to run, reporting results for the rules that are correctly configured.
> 
> ```json
> "toolConfigurationNotifications": [
>   {                                 # A notification object (§3.58).
>     "descriptor": {
>       "id": "UnknownRule"
>     },
>     "associatedRule": {
>       "ruleId": "ABC0001"
>     },
>     "level": "warning",
>     "message": {
>       "text": "Could not disable rule \"ABC0001\"
>                because there is no rule with that id."
>     }
>   }
> ]
> ```

> EXAMPLE 2: A tool is invoked with an unknown command-line argument. The tool reports the problem in `toolConfigurationNotifications`. The tool might report the problem as a warning and continue to run, or it might report the problem as an error and terminate.
> 
> ```json
> "toolConfigurationNotifications": [
>   {                                 # A notification object (§3.58).
>     "descriptor": {
>       "id": "UnknownCommandLineArgument"
>     },
>     "level": "error",
>     "message": {
>       "text": "Command line argument \"/X\" is unknown."
>     }
>   }
> ]
> ```

> EXAMPLE 3: A tool is invoked with a command-line argument that specifies the name of a directory containing files to analyze, but the user who invoked the tool does not have read access to that directory. The tool reports the problem as an error in `toolConfigurationNotifications` and then terminates.
> 
> ```json
> "toolConfigurationNotifications": [
>   {                                 # A notification object (§3.58).
>     "descriptor": {
>       "id": "AccessDenied"
>     },
>     "level": "error",
>     "message": {
>       "text": "Cannot read from directory \"C:\\code\"."
>     }
>   }
> ]
> ```

### stdin, stdout, stderr, and stdoutStderr properties

An `invocation` object **MAY** contain any or all of the properties `stdin`, `stdout`, `stderr`, and `stdoutStderr`, whose values are `artifactLocation` objects ([sec](#artifactlocation-object)) referring to files that contain the input to and output from the SARIF producer process. `stdin`, `stdout`, and `stderr` refer, respectively, to files containing the contents of the standard input, standard output, and standard error streams. `stdoutStderr` refers to a file containing the interleaved contents of the standard output and standard error streams. This is useful when the output of those two streams was written to the same file by means of command shell redirection syntax such as `"> output.txt 2>&1"`.

A SARIF producer **MAY** embed the stream contents in the log file by mentioning the corresponding file in `theRun.artifacts` ([sec](#artifacts-property)) and providing a value for `artifact.contents` ([sec](#artifact-object--contents-property)).
